# 운영체제

---

### 운영체제란?

- 운영체제는 사용자의 하드웨어를 제어하고 프로그램에 대한 일반적 서비스를 지원하는 시스템 소프트웨어
- 운영체제는 컴퓨터 하드웨어가 컴퓨터 소프트웨어와 통신하고 작동하도록 하는 소프트웨어 프로그램

### 운영체제 구조

- 운영체제 구성은 유저 영역과 커널 영역 두 가지로 나뉜다.
- 커널은 운영체제의 핵심 부분으로, 자원할당, 네트워크 관리 등 모든 부분에 대한 기본 서비스를 제공하는 가장 중요한 부분이다.

### 메모리 구조

- 메모리 구조는 코드, 데이터, 힙, 스택 4가지 영역으로 나누어져 있으며 이들 각각을 세그먼드라고 한다. 코드, 데이터 영역은 정적 세그먼트 힙과 스택은 동적 세그먼트
    
    
    - code 영역 : 실행할 프로그램의 코드가 저장되는 텍스트 영역
    - data 영역 : 프로그램의 전역 변수와 정적 변수가 저장되는 영역
    - heap 영역 : 사용자가 직접 관리할 수 있는 메모리 영역으로, 사용자에 의해 메모리 공간이 동적으로 할당되고 해제
    - stack 영역 : 함수의 호출과 관계되는 지역변수와 매개변수가 저장되는 영역, 함수의 호출과 함께 할당되며, 함수의 호출이 종료될 때 해제

### 프로세스란?

- 정의
    - 프로세스는 컴퓨터에서 실행되고 있는 프로그램
- 특징
    - 운영체제로부터 독립된 메모리 영역을 할당
    - 프로세스들은 독립적이므로 통신을 위해 IPC를 사용해야 함
    - 프로세스마다 최소 1개의 쓰레드를 소유

### 프로그램과 프로세스 차이

- 프로그램은 명령어 리스트를 내용으로 가진 저장된 코드, 파일이고, 프로세스는 프로그램의 상태가 메모리 상에서 실행되는 작업 단위

### 프로세스 스케줄링

- 커널 내에는 준비 큐, 대기 큐, 실행 큐 등의 자료 구조가 있으며 커널은 이것들을 이용하여 프로세스의 상태를 관리

- 생성 : 프로세스 생성
- 준비 :  프로세스가 CPU를 사용하고 있지는 않지만 언제든지 사용할 수 있는 상태로, CPU 할당을 기다리는 상태, 일반적으로 우선순위가 높은 프로세스부터 할당
- 실행 : 프로세스가 CPU를 차지하여 명령어들이 실행
- 대기 : 보류라고 부르기도 하며 프로세스가 입출력 완료, 시그널 수신 등 어떤 사건을 기다리는 상태
- 종료 : 프로세스의 실행이 종료

### 멀티 프로세스란?

- 정의
    - 멀티 프로세스는 두개 이상의 다수의 프로세서가 협력하여 하나 이상의 작업을 병렬적으로 처리하는 것
    - 각 프로세스 간 메모리 구분이 필요하거나 독립된 주소 공간을 가져야 할 경우 사용
- 장점
    - 독립된 구조로 안정성이 높은 장점
    - 프로세스 중 하나에 문제가 생겨도 다른 프로세스에 영향을 주지 않아 속도는 느려질 수 있으나 정지되는 문제는 발생하지 않음
    - 여러 개의 프로세스가 처리되는 동안 동일 데이터를 사용하고 데이터를 하나의 디스크에 두고 공유하면 비용적으로 저렴
- 문제점
    - 독립된 메모리 영역이기 때문에 작업량이 많을수록 컨텍스트 스위칭이 자주 일어나서 오버헤드가 발생하여 성능저하가 발생 할 수 있음
    - 컨텍스트 스위칭 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되고 시간이 소모되는 오버헤드 발생

### 컨텍스트 스위칭 (Context Switching) 이란?

- 멀티프로세스 환경에서 CPU가 어떤 하나의 프로세스를 실행하고 있는 상태에서 인터럽트 요청에 의해 다음 우선 순위의 프로세스가 실행되어야 할 때 기존의 프로세스의 상태를 저장하고 CPU가 다음 프로세스를 수행하도록 새로운 프로세스 상태로 교체하는 작업

### 쓰레드란?

- 정의
    - CPU, 프로세서 사용의 기본 단위
    - 프로세스 내에서 할당받은 자원을 이용해 동작하는 실행 단위
- 특징
    - 쓰레드는 프로세스 내에서 Stack만 따로 할당 받고, Code, Data, Heap 영역을 공유
    - 프로세스 자원을 공유하므로 다른 쓰레드에 의한 결과를 즉시 확인 가능
    - 프로세스 내에 존재하며 프로세스가 할당받은 자원을 이용하여 실행
- 장점
    1. 응답성 : 하나의 쓰레드가 blocked 상태인 동안에도 다른 쓰레드는 running이 되어 빠른 응답성
    2. 자원 공유 :  스레드는 프로세스 내의 각종 자원들을 공유하여 동작
    3. 경제적 : 프로세스 생성보다 쓰레드 생성이 더욱 쉽고, 컨텍스트 스위칭시 비용이 적음
    4. 병렬성 : 동일한 일을 수행하는 다중 스레드가 협력하여 높은 처리률과 성능향상

### 멀티 쓰레드란?

- 정의
    - 다수의 쓰레드를 이용하여 하나의 프로그램을 동시에 처리하는 것
    - 하나의 프로그램을 위하여 다수의 실행 단위를 이용한다는 점에서 멀티 프로세싱과 비슷한 의미
- 장점
    - 메모리가 독립적인 프로세스에 비해 공유 메모리만큼의 시간, 자원 손실이 감소
    - 전역 변수와 정적 변수에  대한 자료 공유 가능
- 유의점
    - 다수의 쓰레드가 공유 데이터에 동시에 접근하는 경우 상호 배제 또는 동기화 기법을 통해서 동시성 문제 또는 데드락이 발생하지 않도록 주의
    

### Critical Section(임계 영역)

- critical section은 한순간에 하나의 프로그램만 접근이 가능한 공유 자원에 접근하는 코드 영역을 의미
- 하나의 프로세스가 critical section 내에 있으면 다른 프로세스들이 접근하지 못하도록 상호 배제를 수행
